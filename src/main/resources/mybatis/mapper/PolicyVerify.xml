<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.saonan.mapper.PolicyVerifyMapper">

	<!-- 通过保单ID查询勘察表 -->
	<select id="findPolicyVerifyByPolicyId" parameterType="java.lang.String" resultMap="pvInfo">
		select pol_ver_id, itemid, item_name, site_photo, 
			third_pic, item_age, invoice_pic, invoice, mark, 
			pmodel, house_no, house_pic, address, building_pic, 
			acreage, house_market, house_age, completed_date, 
			verify_date, scout, insureid, coverageid, del_status, 
			yuliu1, yuliu2 
		from policy_verify where insureid = #{policyId}
	</select>
	
	<resultMap type="cn.saonan.pojo.PolicyVerify" id="pvInfo">
		<id property="pol_ver_id" column="pol_ver_id"/>
		<association property="items" column="itemid" select="cn.saonan.mapper.PolicyVerifyMapper.findItemsById" ></association>
		<association property="coverage" column="coverageid" select="cn.saonan.mapper.CoverageMapper.findCoverageById"></association>
	</resultMap>
	
	<!-- 根据清单编号查询清单 -->
	<select id="findItemsById" parameterType="java.lang.Integer" resultType="cn.saonan.pojo.ItemsList">
		select itemid, item_name, deductible, excess, dep_rate, industry, del_status, yuliu from items_list where itemid = #{itemid}
	</select>
	
	<!-- 根据勘察员ID查询属于自己范围的投保单 -->
	<select id="findInsuranceByScout" resultType="cn.saonan.pojo.InsuranceSlip">
		select policyid, insure_name, insure_card, area, address, relation, holder_name, holder_card, holder_sex, holder_phone, holder_email, insure_date, first_auditor, second_auditor, third_auditor, insure_status, scout, scount_status, license, industry_code, acreage, firm_name, userid, premium, pol_property, del_status, paystatus from insurance_slip where scout=#{scout}
	</select>
	
</mapper>